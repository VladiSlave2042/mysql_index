# Домашнее задание к занятию «Индексы» | "Бойко Владислав"
---
## Задание 1
Стыдно, стыдно;
неловко, неловко.
Вроде бы так вот правильно. Получаем что то около 40 %
```mysql
SELECT sum(index_length) / sum(data_length) * 100
FROM INFORMATION_SCHEMA.TABLES
```
![1.1](1.1.png)
---
## Задание 2 
Из прочтенного и проанализированного видно что прям вот узким горлышком является оконная функция, а именно попытка сгруппировать сразу по двум столбцам из разных таблиц
![2.1](2.1.png)
Путем банального удаления f.title и film f из запроса мы получим идентичный результат, но теперь ответ происходит за 10 милисекунд вместо 3.5 секунд 
![2.2](2.2.png)
Далее можно удалить табличку inventory i и соответствующее условие вывод так же не изменится + sql не нужно делать лишние джоины.
UPD насколько понял оконная функция почему то делает обычный тейбл скан, перебекая все строки по пол милиона несколько раз. А добавление индекса в payment amount доло ровным счетом ничего(в целом и не должно было что то дать, т.к. в данном случаее мы не ищим мы складываем строки).
Думается мне что я сделал что то не так.
![2.3](2.3.png)
Что-то там скачет на уровне погрешности
---
## Задание 3
PostgreSQL поддерживает несколько типов индексов: B-дерево, хеш, GiST и SP-GiST(R-дерево), инвертированный индекс, Bitmap, Partial index или же частичный индекс, Function-based index - индексы, ключи которых хранят результат пользовательских функций
В mysql присутствуют В-деревья, хеши(только в таблицах типа memory), есть так же Spatial аналаг для GiST и SP-GiST так же является r-деревом, инвертированный индекс, остальное не поддерживает.
---